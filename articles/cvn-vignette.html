<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Covariate-Varying Networks • CVN</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Covariate-Varying Networks">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CVN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/cvn-vignette.html">Covariate-Varying Networks</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bips-hb/CVN/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="cvn-vignette_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="cvn-vignette_files/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="cvn-vignette_files/vis-9.1.0/vis-network.min.js"></script><script src="cvn-vignette_files/visNetwork-binding-2.1.2/visNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Covariate-Varying Networks</h1>
                        <h4 data-toc-skip class="author">Louis Dijkstra,
Arne Godt, Ronja Foraita</h4>
            
            <h4 data-toc-skip class="date">2025-03-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bips-hb/CVN/blob/main/vignettes/cvn-vignette.Rmd" class="external-link"><code>vignettes/cvn-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>cvn-vignette.Rmd</code></div>
    </div>

    
    
<p>Covariate-varying networks (CVNs) are high-dimensional dynamic
graphical models that vary with multiple external covariates. The
methodology is explained in detail in the pre-print by <a href="https://arxiv.org/abs/2407.19978" class="external-link">Dijkstra, Godt and Foraita
(2024)</a>. In this vignette, we describe how to apply the method to
data with the associated R package <code>CVN</code>.</p>
<div class="section level2">
<h2 id="covariate-varying-networks">Covariate-Varying Networks<a class="anchor" aria-label="anchor" href="#covariate-varying-networks"></a>
</h2>
<p>A graphical model is a powerful tool for exploring complex dependency
structures in high-throughput datasets, such as genomics, epigenomics,
and proteomics. They allow for the investigation of, e.g. biologically,
meaningful patterns that aid in understanding biological processes and
generating new hypotheses. Despite the widespread application of
Gaussian graphical models, there was an urgent need connecting graph
structures to external covariates.</p>
<p>A CVN is a Gaussian graphical model for high-dimensional data that
can change by multiple external <strong>discrete</strong> covariates.
For each combination of the categories between the covariates, a graph
is estimated. This is not done individually, since we allow for
similarities between different graphs related to various covariates. The
smoothness between the graphs in the CVN model is introduced by a
meta-graph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>.
In this meta-graph, each node corresponds to a graph in the CVN model
and an edge between two graphs enforces smoothing between these
graphs.</p>
<p>More formally, a CVN is represented as graphical model with the
quintupel</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">CVN</mtext><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>𝐗</mi><mo>,</mo><mi>𝐔</mi><mo>,</mo><mi>𝒰</mi><mo>,</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐗</mi><mo>∣</mo><mi>𝐔</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mo stretchy="false" form="prefix">{</mo><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>u</mi><mo>∈</mo><mi>𝒰</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
\text{CVN} = \{\mathbf{X}, \mathbf{U}, \mathcal{U}, f(\mathbf{X} \mid \mathbf{U}), 
\{G(u) = (V, E(u)) \}_{u \in \mathcal{U}} \},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐗</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mi>…</mi><mo>,</mo><msub><mi>X</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{X} = (X_1, X_2 \ldots, X_p)^\top</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-dimensional
random vector and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐔</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>U</mi><mn>1</mn></msub><mo>,</mo><msub><mi>U</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>U</mi><mi>q</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{U} = (U_1, U_2, \ldots, U_q)^\top</annotation></semantics></math>
is a random vector representing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
external discrete covariates. The external discrete covariates are not
included in the graph, but they determine the smoothing between all
possible combinations of the covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>K</mi><mi>q</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><annotation encoding="application/x-tex">(K_1,\ldots, K_q)^\top</annotation></semantics></math>
categories.</p>
<p>The vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
lies in the discrete space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒰</mi><annotation encoding="application/x-tex">\mathcal{U}</annotation></semantics></math>
with cardinality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≤</mo><msubsup><mo>∏</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msub><mi>K</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">m \leq \prod_{k=1}^q K_k</annotation></semantics></math>.
The joint density function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
conditioned on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐗</mi><mo>∣</mo><mi>𝐔</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(\mathbf{X} \mid \mathbf{U})</annotation></semantics></math>.
The fifth element of the CVN is a set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
graphs, one for each value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒰</mi><annotation encoding="application/x-tex">\mathcal{U}</annotation></semantics></math>.
The vertices of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">G(u)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">V = \{1, 2, \ldots, p\}</annotation></semantics></math>,
correspond to the variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>X</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">X_1, X_2, \ldots, X_p</annotation></semantics></math>
and do not change with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>.</p>
<p>We assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐗</mi><mo>∣</mo><mi>𝐔</mi></mrow><annotation encoding="application/x-tex">\mathbf{X} \mid \mathbf{U}</annotation></semantics></math>
follows a multivariate normal distribution with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛍</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbf{\mu}(u) = 0</annotation></semantics></math>
and covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝚺</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{\Sigma}(u)</annotation></semantics></math>.
To estimate the structure of the graph, we focus on the precision matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝚯</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝚺</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{\Theta}(u) = \mathbf{\Sigma}(u)^{-1}</annotation></semantics></math>
which has the following property under the normality assumption:</p>
<p><span class="math display">$$
\theta_{ij}(u) = 0 \Leftrightarrow
X_i \not\!\perp\!\!\!\perp X_j \mid \mathbf{X}_{V \setminus \{i,j\}}
\land U = u  
\Leftrightarrow
\text{edge } \{i,j\} \notin E(u)
$$</span> Hence, the (in)dependence structure of the CVN can be
estimated by determining the zero entries of the precision matrices. Our
goal is to enable a CVN to handle high-dimensional data and identify
structural similarities between graphs. We therefore introduce
regularization and smoothness in the definition of the CVN estimator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝚯</mi><mtext mathvariant="normal">CVN</mtext></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mover><mi>𝚯</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><msubsup><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbf{ \Theta}_{\text{CVN}} = \{ \widehat{\mathbf{\Theta}}_i \}_{i = 1}^m</annotation></semantics></math>
as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝚯</mi><mtext mathvariant="normal">CVN</mtext></msub><mo>=</mo><msub><mtext mathvariant="normal">argmin</mtext><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>𝚯</mi><mi>i</mi></msub><msubsup><mo stretchy="false" form="postfix">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup></mrow></msub><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝚯</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mrow><mo stretchy="true" form="prefix">∥</mo><msub><mi>𝚯</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">∥</mo></mrow><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><munder><mo>∑</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></munder><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mrow><mo stretchy="true" form="prefix">∥</mo><msub><mi>𝚯</mi><mi>i</mi></msub><mo>−</mo><msub><mi>𝚯</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">∥</mo></mrow><mn>1</mn></msub><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">]</mo><mo>,</mo></mrow><annotation encoding="application/x-tex"> \mathbf{ \Theta}_{\text{CVN}} = \text{argmin}_{\{ \mathbf{\Theta}_{i}\}_{i = 1}^m} 
    \Bigg[ \sum_{i = 1}^m \ell\left({\mathbf{\Theta}_i}\right) 
     + \lambda_1 \sum_{i = 1}^m \left\rVert \mathbf{\Theta}_i \right\rVert_1 
     + \lambda_2 \sum_{i &lt; j} w_{ij} \left\lVert \mathbf{\Theta}_i - \mathbf{\Theta}_j \right\rVert_1 \Bigg],</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝚯</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf{ \Theta}_i</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
precision matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝚯</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ell\left({\mathbf{\Theta}_i}\right)</annotation></semantics></math>
the log-likelihood function for precision matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math>
values of the symmetric weighted adjacency matrix of the meta-graph (see
below) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1, \lambda_2</annotation></semantics></math>
are two tuning parameters.</p>
<div class="section level3">
<h3 id="meta-graph-w">Meta-Graph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#meta-graph-w"></a>
</h3>
<p>The CVN model might differ from other graphical model approaches
especially through the concept of the (undirected) <em>meta-graph</em>.
The adjacency matrix of the <em>meta-graph</em> equals the weight matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐖</mi><mo>=</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{W} = (w_{ij})_{m \times m}</annotation></semantics></math>,
which is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math>
symmetric matrix. It encodes the smoothing structure between the graphs
in a CVN and must be set <em>a priori</em>.</p>
<p>A weight of 0 does not smooth the structure between two graphs.
Weights must be chosen between 0 and 1.</p>
<p>Here are some examples how
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐖</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math>
and the corresponding <em>meta-graph</em> for a CVN with 2 covariates
can look like:</p>
<table class="table">
<colgroup>
<col width="45%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th align="center">Meta-graph for a CVN <br> with 2 covariates</th>
<th align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐖</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><img src="pics%2Fmg-grid-715_570.png" style="width:60.0%"></td>
<td align="center"><img src="pics%2Fadj1.png" style="width:80.0%"></td>
</tr>
<tr class="even">
<td align="center"><strong>Grid structure</strong></td>
<td align="center"><em>Each covariate has 3 categories</em></td>
</tr>
<tr class="odd">
<td align="center"><img src="pics%2Fmg-grid-w-715_570.png" style="width:60.0%"></td>
<td align="center"><img src="pics%2Fadj5.png" style="width:80.0%"></td>
</tr>
<tr class="even">
<td align="center"><strong>Weighted grid structure</strong></td>
<td align="center"><em>Each covariate has 3 categories</em></td>
</tr>
<tr class="odd">
<td align="center"><img src="pics%2Fmg-2-715_570.png" style="width:60.0%"></td>
<td align="center"><img src="pics%2Fadj2.png" style="width:80.0%"></td>
</tr>
<tr class="even">
<td align="center"><strong>Arbitrary structure</strong></td>
<td align="center"><em>Each covariate has 3 categories</em></td>
</tr>
<tr class="odd">
<td align="center"><img src="pics%2Fmg-glasso-715_570.png" style="width:60.0%"></td>
<td align="center"><img src="pics%2Fadj3.png" style="width:80.0%"></td>
</tr>
<tr class="even">
<td align="center"><strong>GLASSO-type structure</strong></td>
<td align="center">
<strong>No smoothing</strong> <br><em>Each covariate
has 3 categories</em>
</td>
</tr>
<tr class="odd">
<td align="center"><img src="pics%2Fmg-full.png" style="width:60.0%"></td>
<td align="center"><img src="pics%2Fadj4.png" style="width:65.0%"></td>
</tr>
<tr class="even">
<td align="center"><strong>Full/saturated structure</strong></td>
<td align="center">
<strong>Complete smoothing</strong> <br><em>Covariates with 2 and 3 categories</em>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In this fictitious example, we are interested in how the independence
structure of collected biomarkers differ by the 2 external variables
<em><a href="https://en.wikipedia.org/wiki/Body_mass_index" class="external-link">Body mass
index (BMI)</a></em> and <em>income level</em>. The biomarker values
were transformed to normally distributed z-score values. <em>BMI</em>
has the three categories <em>underweight</em>, <em>normal weight</em>,
<em>overweight</em>, and <em>income level</em> has the categories
<em>low</em>, <em>middle</em> and <em>high</em>.</p>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>For this example, we will use randomly simulated data where the
variables in the graph are z-score values of various biomarkers, each
following a normal distribution. We are interested in, if the graphs
differ by the two external variables, each of them having
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mi>L</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">K = L = 3</annotation></semantics></math>
categories.</p>
<p>The <code>CVN</code> function requires as input data:</p>
<ul>
<li><p>A list with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>⋅</mo><mi>L</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">K \cdot L = m</annotation></semantics></math>
data sets</p></li>
<li><p>Each list element needs to be a matrix or a data object of
Gaussian data, corresponding to each combination of the categories of
the two external variables</p></li>
<li><p>The number of variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
must be equal in each list element, the number of observations may
differ.</p></li>
</ul>
<p>The input data is then a list of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>3</mn><mo>=</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">3 \times 3 = 9</annotation></semantics></math>
list elements that corresponding to the combinations (<em>underweight -
low income</em>), (<em>underweight - middle income</em>), …,
(<em>overweight - high income</em>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bips-hb/CVN" class="external-link">CVN</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span>  </span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span>  </span>
<span></span>
<span><span class="co"># Create 10 normally distributed variables for the graph</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add two discrete external covariates</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"middle"</span>, <span class="st">"high"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span><span class="va">data</span><span class="op">$</span><span class="va">bmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"underweight"</span>,<span class="st">"normal weight"</span>, <span class="st">"overweight"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split the dataset into subsets based on dosis and bmi</span></span>
<span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">bmi</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">income</span>, <span class="op">-</span><span class="va">bmi</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data_list</span><span class="op">)</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>income <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"middle"</span>, <span class="st">"high"</span><span class="op">)</span>, </span>
<span>                    bmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"underweight"</span>,<span class="st">"normal weight"</span>, <span class="st">"overweight"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>        <span class="fl">1</span>,</span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="weigth-matrix-and-meta-graph">Weigth Matrix and Meta-Graph<a class="anchor" aria-label="anchor" href="#weigth-matrix-and-meta-graph"></a>
</h3>
<p>We set the <em>meta-graph</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>
in our example to the following: <img src="pics%2Fmg-ex-uw.png" style="width:50.0%" alt="Unweighted meta-graph showing a grid."></p>
<p>In case of two external covariates, the function
<code>create_weight_matrix</code> might be used to generated simple
weight matrices from type <em>full</em> (equals saturated graphs),
<em>grid</em>, <em>glasso</em> and random structures using
<em>uniform-random</em>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plots can be turned on by setting plot = TRUE. Requires the igraph package</span></span>
<span><span class="va">W_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_weight_matrix.html">create_weight_matrix</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"grid"</span>, k <span class="op">=</span> <span class="fl">3</span>, l <span class="op">=</span> <span class="fl">3</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Weight matrices can be plotted as a <em>meta-graph</em> or as
<em>heatmap</em> plot: This can be done in several ways:</p>
<ol style="list-style-type: decimal">
<li><p>A graph output can be generated when creating the weight matrix
using the function <code>create_weight_matrix</code> by setting the
parameter <code>plot=TRUE</code>, or</p></li>
<li><p>by using the <code>plot_weight_matrix</code> function (see
below).</p></li>
<li><p>A heatmap plot is generated using the function
<code>hd_weight_matrix</code>.</p></li>
</ol>
<p>The first two options require the <code>igraph</code> package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># requires the igraph package</span></span>
<span><span class="fu"><a href="../reference/plot_weight_matrix.html">plot_weight_matrix</a></span><span class="op">(</span><span class="va">W_random</span>, k <span class="op">=</span> <span class="fl">3</span>, l <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<p>A heatmap plot looks like the following. Note that it has a dimension
of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math>.
Axis labeling is according to the order of your data_list containing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
data sets.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">W_random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/create_weight_matrix.html">create_weight_matrix</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"uniform-random"</span>, k <span class="op">=</span> <span class="fl">3</span>, l <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/hd_weight_matrix.html">hd_weight_matrix</a></span><span class="op">(</span><span class="va">W_random</span><span class="op">)</span>  <span class="co"># randomly chosen weights</span></span></code></pre></div>
<p><img src="cvn-vignette_tmp_files%2FW-heat-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="tuning-parameter-space">Tuning Parameter Space<a class="anchor" aria-label="anchor" href="#tuning-parameter-space"></a>
</h2>
<p>As know from other methods, e.g., the GLASSO, we need to tune our
model. A CVN requires to select two tuning parameters which control the
regularization applied to the CVN. The choice of the tuning parameters
affects how dense the graphs are and how much the edges between the
graphs have been smoothed. These parameters are usually searched for in
a predefined regularization path.</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
governs the sparsity in the CVN, which gets sparser the larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
is chosen.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>
is responsible for regulating the smoothness or similarity between the
graphs by penalizing the differences between the precision matrices that
are connected in the meta-graph. It encourages similar values in the
precision matrices and hence also if an edge is included in the graph or
not. The graphs in the CVN are getting more and more similar the larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>
is selected.</p></li>
</ul>
<p>The <code>CVN</code> function fits all combinations for a given
selection of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>
values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lets define a regularization path for each tuning parameter</span></span>
<span><span class="va">lambda1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># sparsity</span></span>
<span><span class="va">lambda2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>                <span class="co"># smoothing</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimate-a-cvn">Estimate a CVN<a class="anchor" aria-label="anchor" href="#estimate-a-cvn"></a>
</h2>
<p>A CVN graphical model is fitted using an alternating direction method
of multipliers (ADMM). By default, the <code>CVN</code> function will
parallelize when multiple values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>
are provided. However, the number of cores used can be adjusted by
setting, e.g, <code>n_cores = 1</code>.</p>
<p>The CVN is simply estimated by the following.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CVN.html">CVN</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_list</span>, </span>
<span>              W <span class="op">=</span> <span class="va">W_grid</span>, </span>
<span>        lambda1 <span class="op">=</span> <span class="va">lambda1</span>, </span>
<span>        lambda2 <span class="op">=</span> <span class="va">lambda2</span>, </span>
<span>            eps <span class="op">=</span> <span class="fl">1e-2</span>,       <span class="co"># makes it faster but less precise; default = 1e-4</span></span>
<span>        maxiter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>        n_cores <span class="op">=</span> <span class="fl">1</span>,          <span class="co"># no parallizing</span></span>
<span>      warmstart <span class="op">=</span> <span class="cn">TRUE</span>,       <span class="co"># uses the glasso</span></span>
<span>        verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cvn</span><span class="op">)</span></span>
<span><span class="co">#&gt; Covariate-varying Network (CVN)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✓ all converged</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span>Number of graphs (m)    : 9</span></span>
<span><span class="co">#&gt; Number of variables (p) : 10</span></span>
<span><span class="co">#&gt; Number of lambda pairs  : 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weight matrix (W):</span></span>
<span><span class="co">#&gt; 9 x 9 sparse Matrix of class "dsCMatrix"</span></span>
<span><span class="co">#&gt;                        </span></span>
<span><span class="co">#&gt;  [1,] . 1 . 1 . . . . .</span></span>
<span><span class="co">#&gt;  [2,] 1 . 1 . 1 . . . .</span></span>
<span><span class="co">#&gt;  [3,] . 1 . . . 1 . . .</span></span>
<span><span class="co">#&gt;  [4,] 1 . . . 1 . 1 . .</span></span>
<span><span class="co">#&gt;  [5,] . 1 . 1 . 1 . 1 .</span></span>
<span><span class="co">#&gt;  [6,] . . 1 . 1 . . . 1</span></span>
<span><span class="co">#&gt;  [7,] . . . 1 . . . 1 .</span></span>
<span><span class="co">#&gt;  [8,] . . . . 1 . 1 . 1</span></span>
<span><span class="co">#&gt;  [9,] . . . . . 1 . 1 .</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   id lambda1 lambda2      gamma1       gamma2 converged       value</span></span>
<span><span class="co">#&gt; 1  1    0.50     1.0 0.001234568 0.0006172840      TRUE 0.008176557</span></span>
<span><span class="co">#&gt; 2  2    1.25     1.0 0.003086420 0.0006172840      TRUE 0.008932883</span></span>
<span><span class="co">#&gt; 3  3    2.00     1.0 0.004938272 0.0006172840      TRUE 0.009769567</span></span>
<span><span class="co">#&gt; 4  4    0.50     1.5 0.001234568 0.0009259259      TRUE 0.009720175</span></span>
<span><span class="co">#&gt; 5  5    1.25     1.5 0.003086420 0.0009259259      TRUE 0.009410001</span></span>
<span><span class="co">#&gt; 6  6    2.00     1.5 0.004938272 0.0009259259      TRUE 0.009319307</span></span>
<span><span class="co">#&gt;   n_iterations      aic      bic      ebic edges_median edges_iqr</span></span>
<span><span class="co">#&gt; 1           16 5255.323 6071.667  8586.090           29         6</span></span>
<span><span class="co">#&gt; 2           19 4763.677 5258.571  6778.278           18         3</span></span>
<span><span class="co">#&gt; 3           22 4476.400 4769.034  5662.437           10         2</span></span>
<span><span class="co">#&gt; 4           19 5724.758 6922.427 10606.563           44         1</span></span>
<span><span class="co">#&gt; 5           22 4682.392 5122.325  6476.245           16         3</span></span>
<span><span class="co">#&gt; 6           26 4404.656 4651.844  5407.092            8         1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="an-alternative-tuning-parameterization">An Alternative Tuning Parameterization<a class="anchor" aria-label="anchor" href="#an-alternative-tuning-parameterization"></a>
</h2>
<p>In our manuscript, we also introduce an alternative tuning
parameterization. Due to the algorithm’s computational complexity,
performing an exhaustive naive search across a broad range of potential
values is usually not feasible. We realized that introducing a different
external covariate, thereby altering the number of graphs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>,
or considering different variables, which changes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,
impacts the interpretation and meaning of the tuning parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>.
In other words, if one selects optimal values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>
and then slightly alters the dataset, these values may no longer be
informative for the new dataset.</p>
<p>To address this issue, we propose a new parameterization, denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\gamma_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\gamma_2</annotation></semantics></math>,
replacing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>.
Unlike the previous tuning parameters that penalize the entire precision
matrix and differences between precision matrices,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\gamma_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\gamma_2</annotation></semantics></math>
are used to penalize individual edges.</p>
<p>This alternative tuning parameterization remains robust when changing
the number of variables or graphs in the CVN model. This might also be
beneficial for other applications as well.</p>
<p>The results table of the CVN model includes the gamma tuning
parameters by default, which<br>
are much smaller than the lambda values (see our manuscript for more
information).</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="2%">
<col width="6%">
<col width="6%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="7%">
<col width="7%">
<col width="8%">
<col width="10%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">lambda1</th>
<th align="right">lambda2</th>
<th align="right">gamma1</th>
<th align="right">gamma2</th>
<th align="left">converged</th>
<th align="right">value</th>
<th align="right">n_iterations</th>
<th align="right">aic</th>
<th align="right">bic</th>
<th align="right">ebic</th>
<th align="right">edges_median</th>
<th align="right">edges_iqr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.50</td>
<td align="right">1.0</td>
<td align="right">0.0012346</td>
<td align="right">0.0006173</td>
<td align="left">TRUE</td>
<td align="right">0.0081766</td>
<td align="right">16</td>
<td align="right">5255.323</td>
<td align="right">6071.667</td>
<td align="right">8586.090</td>
<td align="right">29</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1.25</td>
<td align="right">1.0</td>
<td align="right">0.0030864</td>
<td align="right">0.0006173</td>
<td align="left">TRUE</td>
<td align="right">0.0089329</td>
<td align="right">19</td>
<td align="right">4763.677</td>
<td align="right">5258.571</td>
<td align="right">6778.278</td>
<td align="right">18</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2.00</td>
<td align="right">1.0</td>
<td align="right">0.0049383</td>
<td align="right">0.0006173</td>
<td align="left">TRUE</td>
<td align="right">0.0097696</td>
<td align="right">22</td>
<td align="right">4476.400</td>
<td align="right">4769.034</td>
<td align="right">5662.437</td>
<td align="right">10</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.50</td>
<td align="right">1.5</td>
<td align="right">0.0012346</td>
<td align="right">0.0009259</td>
<td align="left">TRUE</td>
<td align="right">0.0097202</td>
<td align="right">19</td>
<td align="right">5724.758</td>
<td align="right">6922.427</td>
<td align="right">10606.563</td>
<td align="right">44</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1.25</td>
<td align="right">1.5</td>
<td align="right">0.0030864</td>
<td align="right">0.0009259</td>
<td align="left">TRUE</td>
<td align="right">0.0094100</td>
<td align="right">22</td>
<td align="right">4682.392</td>
<td align="right">5122.325</td>
<td align="right">6476.245</td>
<td align="right">16</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2.00</td>
<td align="right">1.5</td>
<td align="right">0.0049383</td>
<td align="right">0.0009259</td>
<td align="left">TRUE</td>
<td align="right">0.0093193</td>
<td align="right">26</td>
<td align="right">4404.656</td>
<td align="right">4651.844</td>
<td align="right">5407.092</td>
<td align="right">8</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="selecting-tuning-parameters">Selecting Tuning Parameters<a class="anchor" aria-label="anchor" href="#selecting-tuning-parameters"></a>
</h2>
<p>After fitting the CVN models, the next step involves selecting
suitable values for the tuning parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\lambda_1, \lambda_2)</annotation></semantics></math>
or for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>γ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\gamma_1, \gamma_2)</annotation></semantics></math>.
The choice of the tuning parameter determine the network structure and
it is thus an important and challenging step.</p>
<div class="section level3">
<h3 id="information-criteria">Information Criteria<a class="anchor" aria-label="anchor" href="#information-criteria"></a>
</h3>
<p>The CVN package provides the Akaike Information Criteria (AIC), the
Bayesian Information Criteria (BIC) and the extended BIC, which can be
used to select suitable values for the tuning parameters.</p>
<p>The calculation of the eBIC requires to set the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mrow><mi>e</mi><mi>B</mi><mi>I</mi><mi>C</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma_{eBIC} \in [0,1]</annotation></semantics></math>.
It is by default set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mrow><mi>e</mi><mi>b</mi><mi>i</mi><mi>c</mi></mrow></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\gamma_{ebic} = 0.5</annotation></semantics></math>.
All three information criteria are returned in the CVN result table.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print results</span></span>
<span><span class="va">cvn</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt;   id lambda1 lambda2      gamma1       gamma2 converged       value</span></span>
<span><span class="co">#&gt; 1  1    0.50     1.0 0.001234568 0.0006172840      TRUE 0.008176557</span></span>
<span><span class="co">#&gt; 2  2    1.25     1.0 0.003086420 0.0006172840      TRUE 0.008932883</span></span>
<span><span class="co">#&gt; 3  3    2.00     1.0 0.004938272 0.0006172840      TRUE 0.009769567</span></span>
<span><span class="co">#&gt; 4  4    0.50     1.5 0.001234568 0.0009259259      TRUE 0.009720175</span></span>
<span><span class="co">#&gt; 5  5    1.25     1.5 0.003086420 0.0009259259      TRUE 0.009410001</span></span>
<span><span class="co">#&gt; 6  6    2.00     1.5 0.004938272 0.0009259259      TRUE 0.009319307</span></span>
<span><span class="co">#&gt;   n_iterations      aic      bic      ebic edges_median edges_iqr</span></span>
<span><span class="co">#&gt; 1           16 5255.323 6071.667  8586.090           29         6</span></span>
<span><span class="co">#&gt; 2           19 4763.677 5258.571  6778.278           18         3</span></span>
<span><span class="co">#&gt; 3           22 4476.400 4769.034  5662.437           10         2</span></span>
<span><span class="co">#&gt; 4           19 5724.758 6922.427 10606.563           44         1</span></span>
<span><span class="co">#&gt; 5           22 4682.392 5122.325  6476.245           16         3</span></span>
<span><span class="co">#&gt; 6           26 4404.656 4651.844  5407.092            8         1</span></span>
<span></span>
<span><span class="co"># which combination of lambda values shows the best AIC?</span></span>
<span><span class="va">best.aic</span> <span class="op">&lt;-</span> <span class="va">cvn</span><span class="op">$</span><span class="va">results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">cvn</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span>, <span class="st">"id"</span><span class="op">]</span></span>
<span><span class="va">cvn</span><span class="op">$</span><span class="va">results</span><span class="op">[</span><span class="va">best.aic</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;   id lambda1 lambda2      gamma1       gamma2 converged       value</span></span>
<span><span class="co">#&gt; 6  6       2     1.5 0.004938272 0.0009259259      TRUE 0.009319307</span></span>
<span><span class="co">#&gt;   n_iterations      aic      bic     ebic edges_median edges_iqr</span></span>
<span><span class="co">#&gt; 6           26 4404.656 4651.844 5407.092            8         1</span></span></code></pre></div>
<blockquote>
<p>👍 <strong>Rule of thumb:</strong> The smaller the IC value, the
better the fit.</p>
</blockquote>
<p>The package contains also an option of plotting the results of the
information criteria. The plot is a map of all IC values for every
tuning parameter combination fitted by CVN. The yellow dot denotes the
tuning parameter combination which shows the smallest IC value.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_information_criterion.html">plot_information_criterion</a></span><span class="op">(</span><span class="va">cvn</span>, criterion <span class="op">=</span> <span class="st">"aic"</span>, use_gammas <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="cvn-vignette_tmp_files%2Ficplot-1.png" width="100%"></p>
<p>It is also possible to change the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>-value
for the eBIC. The default is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\gamma = 0.5</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">dic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/determine_information_criterion_cvn.html">determine_information_criterion_cvn</a></span><span class="op">(</span><span class="va">cvn</span>, gamma <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]    </span></span>
<span><span class="co">#&gt; aic  5255.323 4763.677 4476.4   5724.758 4682.392 4404.656</span></span>
<span><span class="co">#&gt; bic  6071.667 5258.571 4769.034 6922.427 5122.325 4651.844</span></span>
<span><span class="co">#&gt; ebic 10597.63 7994.042 6377.159 13553.87 7559.381 6011.29</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">IC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">minimal AIC:</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">minimal BIC:</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">minimal eBIC with gamma = 0.5:</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">minimal eBIC with gamma = 0.9:</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>Based on the information criteria, we select CVN 6. Here, all IC
measures decide in favour of ID 6. However, this is not always the case.
In principle, the AIC selects slightly denser models than the BIC. For
tuning graphs, many prefer the eBIC, although you have specify a value
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mrow><mi>e</mi><mi>B</mi><mi>I</mi><mi>C</mi></mrow></msub><annotation encoding="application/x-tex">\gamma_{eBIC}</annotation></semantics></math>
as well.</p>
<p>Our simulations showed better results in detecting the true
underlying graph for using the AIC than the BIC (eBIC was not included
in the comparison). But in general do both perform rather poorly in
practice.</p>
</div>
<div class="section level3">
<h3 id="other-possibilities-to-select-a-cvn-model">Other possibilities to select a CVN model<a class="anchor" aria-label="anchor" href="#other-possibilities-to-select-a-cvn-model"></a>
</h3>
<p>Although ICs are objective measures, they sometimes provide useless
graphs (too sparse, to dense, …).</p>
<p>There are other approaches that can be used to find a suitable graph
structure, like stability approaches. These, however, are based on
resampling strategies which demand a lot of computational power.</p>
<p>Others prefer to assume a sparsity or density value and select the
graph that comes closest to that threshold We output therefore also the
median number of edges and the interquartile range (IQR) across the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
estimated graphs of the CVN results output (see above).</p>
</div>
</div>
<div class="section level2">
<h2 id="exploring-a-cvn">Exploring a CVN<a class="anchor" aria-label="anchor" href="#exploring-a-cvn"></a>
</h2>
<p>Once a graph has been selected, there is usually an interest in
further investigation of its structure etc.</p>
<div class="section level3">
<h3 id="extract-one-cvn-model">Extract one CVN model<a class="anchor" aria-label="anchor" href="#extract-one-cvn-model"></a>
</h3>
<p>The process becomes easier if the CVN model of interest is extracted
as a single object from the list of fitted CVNs for further
investigation.</p>
<p>In our example, we aim to examine the CVN with the lowest AIC value,
which corresponds to the model with ID 6.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_cvn.html">extract_cvn</a></span><span class="op">(</span><span class="va">cvn</span>, <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-a-cvn-model">Plot a CVN model<a class="anchor" aria-label="anchor" href="#plot-a-cvn-model"></a>
</h3>
<p>All subgraphs of a CVN model can be easily plotted. The function
requires the <code>visnet</code> package to visualize the network
structure of each CVN subgraphs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_cvn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit6</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div style="display: grid; grid-template-columns: repeat(3, 1fr); 
                 column-gap: 1px; row-gap: 0px">
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,1,2,2,2,3,3,4,4,5,5,7,8,9],"to":[5,7,3,8,9,4,6,7,9,6,9,9,9,10],"width":[3,1,1,1,1,1,1,1,1,1,1,1,1,1],"color":["red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,1,1,3,4,4,5,5,9],"to":[5,7,9,6,6,7,6,7,10],"width":[3,1,1,1,1,1,1,1,1],"color":["red","blue","blue","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,1,1,1,3,3,4,5],"to":[2,5,7,9,8,9,6,6],"width":[1,3,1,1,1,1,1,1],"color":["blue","red","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,1,3,3,4,4,4,5,6],"to":[5,7,5,10,7,9,10,7,7],"width":[3,1,1,1,1,1,1,1,1],"color":["red","blue","blue","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,1,3,3,4,4,5,9],"to":[5,7,7,10,6,7,7,10],"width":[3,1,1,1,1,1,1,1],"color":["red","blue","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-10b3b7155e8045a1b2ad" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,1,1,2,3,4,4,4],"to":[5,7,8,7,9,6,7,9],"width":[3,1,1,1,1,1,1,1],"color":["red","blue","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-4018eef1a407a0df6b52" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,1,3,3,3,4,4,4,4,5,6],"to":[5,6,5,6,10,7,8,9,10,7,7],"width":[3,1,1,1,1,1,1,1,1,1,1],"color":["red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-5b1b2f4ad92281566982" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-5b1b2f4ad92281566982">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,3,3,4,4,5,5,6],"to":[5,8,10,7,9,7,8,10],"width":[3,1,1,1,1,1,1,1],"color":["red","blue","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-25c3e940e6859592f801" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-25c3e940e6859592f801">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,3,3,4,4,5,6],"to":[5,4,8,7,9,10,10],"width":[3,1,1,1,1,1,1],"color":["red","blue","blue","blue","blue","blue","blue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<p>The plot shows edges with different color coding:</p>
<ul>
<li><p><strong>Red edges:</strong> The edges are present in all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
subgraphs and are referred to as <em>core edges</em>.</p></li>
<li><p><strong>Blue edges:</strong> These edges are absent from at least
one of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
subgraphs.</p></li>
</ul>
<p>It is also possible to generate all plots for every tuning parameter
constellation over all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
fitted graphs in one function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cvn</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="differences-between-cvn-subgraphs">Differences between CVN subgraphs<a class="anchor" aria-label="anchor" href="#differences-between-cvn-subgraphs"></a>
</h3>
<p>In order to examine the differences between the subgraphs of a CVN
model, it is possible to determine the number of edges in each CVN
subgraph and to analyze the Hamming distances between the subgraphs.</p>
<p>The <strong>Hamming distance</strong> between two graphs with the
same set of nodes is the number of edges that differ between them. It is
calculated by counting the edges that need to be added or removed to
transform one graph into the other.</p>
<p>The following code shows the number of edges in each subgraph
<em>(E(g1), …, E(g9))</em>, the number of edges that are shared by all
graphs <em>(E(core))</em> and the number of edges that are unique for
each subgraph <em>(E(g1_u),…, E(g9_u))</em>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cvn_edge_summary.html">cvn_edge_summary</a></span><span class="op">(</span><span class="va">cvn</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E(g1) E(g2) E(g3) E(g4) E(g5) E(g6) E(g7) E(g8) E(g9) E(core) E(g1_u) E(g2_u)</span></span>
<span><span class="co">#&gt; 1    68    52    56    64    56    56    68    68    58      12       6       0</span></span>
<span><span class="co">#&gt; 2    44    32    36    38    32    30    44    38    36       1      14       0</span></span>
<span><span class="co">#&gt; 3    28    22    20    22    18    16    36    18    14       0      12       2</span></span>
<span><span class="co">#&gt; 4    90    88    88    88    88    88    90    90    90      44       0       0</span></span>
<span><span class="co">#&gt; 5    36    28    30    32    32    28    38    38    32       2      12       0</span></span>
<span><span class="co">#&gt; 6    28    18    16    18    16    16    22    16    14       1      12       0</span></span>
<span><span class="co">#&gt;   E(g3_u) E(g4_u) E(g5_u) E(g6_u) E(g7_u) E(g8_u) E(g9_u)</span></span>
<span><span class="co">#&gt; 1       0       0       0       0       0       0       0</span></span>
<span><span class="co">#&gt; 2       0       0       2       0       4       0       0</span></span>
<span><span class="co">#&gt; 3       4       0       2       0      10       0       2</span></span>
<span><span class="co">#&gt; 4       0       0       0       0       0       0       0</span></span>
<span><span class="co">#&gt; 5       4       0       2       0       4       2       2</span></span>
<span><span class="co">#&gt; 6       2       0       2       4       4       2       2</span></span></code></pre></div>
<p>You can also print the summary for one extracted CVN (fit6 in the
example). The ouptut shows than the number of edges in each subgraph
<em>(edges)</em>, the number of edges that are shared by all subgraphs
<em>(core_edges)</em>, and the number of edges that are unique for this
particular subgraph <em>(unique_edges)</em>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cvn_edge_summary.html">cvn_edge_summary</a></span><span class="op">(</span><span class="va">fit6</span><span class="op">)</span></span>
<span><span class="co">#&gt;   edges core_edges unique_edges</span></span>
<span><span class="co">#&gt; 1    28          1           12</span></span>
<span><span class="co">#&gt; 2    18          1            0</span></span>
<span><span class="co">#&gt; 3    16          1            2</span></span>
<span><span class="co">#&gt; 4    18          1            0</span></span>
<span><span class="co">#&gt; 5    16          1            2</span></span>
<span><span class="co">#&gt; 6    16          1            4</span></span>
<span><span class="co">#&gt; 7    22          1            4</span></span>
<span><span class="co">#&gt; 8    16          1            2</span></span>
<span><span class="co">#&gt; 9    14          1            2</span></span></code></pre></div>
<p>You have the option to return the result as a matrix or as a heatmap
plot. The number in each cell reflects the number of different edges
between two graphs.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate Hamming distance matrix and plot it as heat map</span></span>
<span><span class="co"># plot_hamming_distances_cvn(fit3)</span></span>
<span></span>
<span><span class="va">hd_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hamming_distance_adj_matrices.html">hamming_distance_adj_matrices</a></span><span class="op">(</span><span class="va">fit6</span><span class="op">$</span><span class="va">adj_matrices</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/plot_hamming_distances.html">plot_hamming_distances</a></span><span class="op">(</span><span class="va">hd_matrix</span><span class="op">)</span></span></code></pre></div>
<p><img src="cvn-vignette_tmp_files%2Fhamming-distance-1.png" width="768"></p>
<p>As expected, the heatmap shows that the graph structures change
randomly along the two covariates. No pattern can be seen</p>
</div>
</div>
<div class="section level2">
<h2 id="interpolation-of-subgraphs-based-an-previously-fitted-cvn-model">Interpolation of subgraphs based an previously fitted CVN model<a class="anchor" aria-label="anchor" href="#interpolation-of-subgraphs-based-an-previously-fitted-cvn-model"></a>
</h2>
<p>We have also proposed a method to interpolate a subgraph for which we
do not have collected data. This can be done using an estimated CVN
model based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
graphs. Let us assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">G_{m+1}</annotation></semantics></math>
represent the graph we want to interpolate.</p>
<p>For this, we need to set a vector of smoothing coefficients that
determine the amount of smoothing between the new graph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">G_{m+1}</annotation></semantics></math>
and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
original graphs.</p>
<p>For example, suppose we want to interpolate a graph smoothed by
graphs 8 and 9, where the structure is weighted by 0.5 each.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># interpolate generates objects of class 'cvn_interpolate'</span></span>
<span><span class="va">interpolate6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interpolate.html">interpolate</a></span><span class="op">(</span><span class="va">fit6</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>, truncate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">cvn6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_cvn_interpolated.html">combine_cvn_interpolated</a></span><span class="op">(</span><span class="va">fit6</span>, <span class="va">interpolate6</span><span class="op">)</span></span>
<span><span class="co"># plot with title</span></span>
<span><span class="va">plot10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visnetwork_cvn.html">visnetwork_cvn</a></span><span class="op">(</span><span class="va">cvn6</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>               title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">cvn6</span><span class="op">$</span><span class="va">n_lambda_values</span>, </span>
<span>                         <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">cvn6</span><span class="op">$</span><span class="va">m</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Graph"</span>, <span class="va">j</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span>                         <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div style="display: grid; grid-template-columns: repeat(3, 1fr); 
                 column-gap: 1px; row-gap: -10px">
<div id="htmlwidget-3f27c09be0c60bb52829" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f27c09be0c60bb52829">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,3,3,4,4,5,5,6],"to":[5,8,10,7,9,7,8,10]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Graph 8","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-416566eb193bf50d04e6" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-416566eb193bf50d04e6">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[1,3,3,4,4,5,6],"to":[5,4,8,7,9,10,10]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Graph 9","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-72cbf064100ce560a04c" style="width:100%;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-72cbf064100ce560a04c">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"title":[1,2,3,4,5,6,7,8,9,10],"x":[1,0.8090169943749475,0.3090169943749475,-0.3090169943749473,-0.8090169943749473,-1,-0.8090169943749476,-0.3090169943749476,0.3090169943749472,0.8090169943749475],"y":[0,0.6180339887498949,1,1,0.6180339887498951,2.220446049250313e-16,-0.6180339887498947,-0.9999999999999999,-1,-0.6180339887498951],"label":["1","2","3","4","5","6","7","8","9","10"]},"edges":{"from":[3,3,3,4,4,5,5,5,6],"to":[4,8,10,7,9,7,8,10,10]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Graph 10","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<p>Note, that the function is still work in progress and we did not yet
investigate its performance in simulation study. It should therefore be
used with caution.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ronja Foraita, Louis Dijkstra, DFG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
